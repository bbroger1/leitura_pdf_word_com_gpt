(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5101,3299],{86224:function(e,t,a){"use strict";var n,s,r=a(86006);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}t.Z=function(e){return r.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),n||(n=r.createElement("defs",null,r.createElement("path",{id:"clear_svg__a",d:"M0 0h16v16H0z"}))),r.createElement("g",null,s||(s=r.createElement("mask",{id:"clear_svg__b",fill:"#fff"},r.createElement("use",{xlinkHref:"#clear_svg__a"}))),r.createElement("g",{mask:"url(#clear_svg__b)"},r.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M1 9.67h8.67l1-9.67H0l1 9.67Z",transform:"translate(2.667 5)"}),r.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M0 0v3.33",transform:"translate(6.667 8.334)"}),r.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M0 0v3.33",transform:"translate(9.334 8.333)"}),r.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"m0 4 5.44-4L8 4",transform:"translate(4 1)"}))))}},26640:function(e,t,a){"use strict";a.d(t,{UK:function(){return o},YZ:function(){return l},x6:function(){return i}});var n=a(86006),s=a(54963),r=a(1405);function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,a]=(0,s.lr)();(0,n.useEffect)(()=>{let n=!1;t.forEach((a,s)=>{"function"==typeof e[s]&&(e[s](a),t.delete(s),n=!0)}),n&&a(t)},[t,e])}let i=":";function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function t(e){return e.startsWith(i)?e.slice(1):e}return{match:function(a){let n=t(a),s="function"==typeof e[n];return{matched:s,invoke:()=>s&&e[n](a)}},search:function(a){let n=t(a),s=r.ZP.Chat.Commands;return Object.keys(e).filter(e=>e.startsWith(n)).map(e=>({title:s[e],content:i+e}))}}}},80626:function(e,t,a){"use strict";a.r(t),a.d(t,{Chat:function(){return tf},ChatActions:function(){return th},DeleteImageButton:function(){return tg},EditMessageModal:function(){return tu},PromptHints:function(){return tc},SessionConfigModel:function(){return ti}});var n,s,r,l,i,o,c,m,d,h,u,g,p,f,v,x,w,_,k,y,j,E,b,C,S,M,P,N,O,Z,A,H,T,I=a(9268),z=a(19357),D=a(86006);function K(){return(K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var F=function(e){return D.createElement("svg",K({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),n||(n=D.createElement("defs",null,D.createElement("path",{id:"send-white_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,s||(s=D.createElement("mask",{id:"send-white_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#send-white_svg__a"}))),D.createElement("g",{mask:"url(#send-white_svg__b)"},D.createElement("path",{style:{stroke:"#fff",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M0 4.71 6.67 6l1.67 6.67L12.67 0 0 4.71Z",transform:"translate(1.333 2)"}),D.createElement("path",{style:{stroke:"#fff",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M0 1.89 1.89 0",transform:"translate(8.003 6.117)"}))))};function L(){return(L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var R=function(e){return D.createElement("svg",L({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),r||(r=D.createElement("defs",null,D.createElement("path",{id:"brain_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,l||(l=D.createElement("mask",{id:"brain_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#brain_svg__a"}))),D.createElement("g",{mask:"url(#brain_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M5.01 13.33c-.32-1.06-.82-1.86-1.48-2.38-.98-.78-2.56-.3-3.14-1.11-.58-.8.41-2.29.76-3.17.34-.88-1.33-1.19-1.13-1.44.13-.16.97-.64 2.53-1.44C3 1.26 4.63 0 7.47 0c4.24 0 5.86 3.6 5.86 5.89 0 2.29-1.96 4.76-4.75 5.29-.25.37.11 1.08 1.08 2.15",transform:"translate(1.333 1.333)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M2.1 3.33c-.19 1.09.04 1.6.69 1.53.65-.07 1.05-.34 1.18-.81 1.02.28 1.57.04 1.66-.72.12-1.15-.5-2.07-.75-2.07s-.91-.03-.91-.38C3.97.52 3.2.33 2.5.33c-.69 0-.27-.47-1.23-.29C.64.17.26.44.13.88c-.22.84-.16 1.43.19 1.78.35.34.94.56 1.78.67Z",transform:"translate(6.374 3.957)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M1.97 0c-.34.21-.8.56-1 .83-.49.69-.88 1.1-.97 1.54",transform:"translate(8.193 8.5)"}))))};function B(){return(B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var W=function(e){return D.createElement("svg",B({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),i||(i=D.createElement("defs",null,D.createElement("path",{id:"rename_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,o||(o=D.createElement("mask",{id:"rename_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#rename_svg__a"}))),D.createElement("g",{mask:"url(#rename_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M2.83 13.2 13.2 2.83 10.37 0 0 10.37v2.83h2.83Z",transform:"translate(1.775 1.3)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"m0 0 2.83 2.83",transform:"translate(9.317 4.13)"}))))};function U(){return(U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var G=function(e){return D.createElement("svg",U({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),c||(c=D.createElement("defs",null,D.createElement("path",{id:"share_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,m||(m=D.createElement("mask",{id:"share_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#share_svg__a"}))),D.createElement("g",{mask:"url(#share_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M6.67 3.67C1.67 3.67 0 7.33 0 13c0 0 2-5 6.67-5v3.67l6-5.67-6-6v3.67Z",transform:"translate(2 1.333)"}))))};function X(){return(X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Y=function(e){return D.createElement("svg",X({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),d||(d=D.createElement("defs",null,D.createElement("path",{id:"return_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,h||(h=D.createElement("mask",{id:"return_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#return_svg__a"}))),D.createElement("g",{mask:"url(#return_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M2.33 0 0 2l2.33 2.33",transform:"translate(2 2.667)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M0 0h7.66c2.3 0 4.25 1.87 4.34 4.17.09 2.42-1.91 4.5-4.34 4.5H2",transform:"translate(2 4.667)"}))))},Q=a(46011),V=a(70359);function J(){return(J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var q=function(e){return D.createElement("svg",J({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"#fff"},e),u||(u=D.createElement("rect",{width:"100%",height:"100%",fill:"none"})),g||(g=D.createElement("g",{className:"loading_svg__currentLayer"},D.createElement("circle",{cx:4,cy:8,r:1.926,fill:"#333"},D.createElement("animate",{attributeName:"r",begin:"0s",calcMode:"linear",dur:"0.8s",from:2,repeatCount:"indefinite",to:2,values:"2;1.2;2"}),D.createElement("animate",{attributeName:"fill-opacity",begin:"0s",calcMode:"linear",dur:"0.8s",from:1,repeatCount:"indefinite",to:1,values:"1;.5;1"})),D.createElement("circle",{cx:8,cy:8,r:1.274,fill:"#333",fillOpacity:.3},D.createElement("animate",{attributeName:"r",begin:"0s",calcMode:"linear",dur:"0.8s",from:1.2,repeatCount:"indefinite",to:1.2,values:"1.2;2;1.2"}),D.createElement("animate",{attributeName:"fill-opacity",begin:"0s",calcMode:"linear",dur:"0.8s",from:.5,repeatCount:"indefinite",to:.5,values:".5;1;.5"})),D.createElement("circle",{cx:12,cy:8,r:1.926,fill:"#333"},D.createElement("animate",{attributeName:"r",begin:"0s",calcMode:"linear",dur:"0.8s",from:2,repeatCount:"indefinite",to:2,values:"2;1.2;2"}),D.createElement("animate",{attributeName:"fill-opacity",begin:"0s",calcMode:"linear",dur:"0.8s",from:1,repeatCount:"indefinite",to:1,values:"1;.5;1"})))))};function $(){return($=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var ee=function(e){return D.createElement("svg",$({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),p||(p=D.createElement("defs",null,D.createElement("path",{id:"prompt_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,f||(f=D.createElement("mask",{id:"prompt_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#prompt_svg__a"}))),D.createElement("g",{mask:"url(#prompt_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3,strokeOpacity:1,strokeDasharray:"0 0"},d:"m1.367 1.367 1.41 1.41M4.667 0v2m0 0V0m3.295 1.367-1.41 1.41m0 0 1.41-1.41m1.371 3.3h-2m0 0h2m-1.37 3.295-1.41-1.41m0 0 1.41 1.41M4.666 9.333v-2m0 0v2m-3.3-1.37 1.41-1.41m0 0-1.41 1.41M0 4.666h2m0 0H0",transform:"translate(5.333 1.333)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M8.01 0 0 8.01",transform:"translate(1.848 6.138)"}))))},et=a(52095),ea=a(43709),en=a(33506),es=a(51150);function er(){return(er=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var el=function(e){return D.createElement("svg",er({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),D.createElement("path",{style:{fill:"#333",opacity:1},d:"M13.275-.275c.261.26.392.576.392.945v10.66c0 .37-.131.684-.392.945a1.288 1.288 0 0 1-.945.392H1.67c-.37 0-.684-.13-.945-.392a1.288 1.288 0 0 1-.392-.945V.67c0-.37.13-.684.392-.945.26-.261.576-.392.945-.392h10.66c.369 0 .684.13.945.392zM1.667 11.33c0 .002 0 .003.003.003h10.66c.002 0 .003 0 .003-.003V.67c0-.002 0-.003-.003-.003H1.67c-.002 0-.003 0-.003.003z",transform:"translate(1 2)"}),D.createElement("path",{style:{fill:"#333",opacity:1},d:"M9.763 7.507a.666.666 0 0 1-.867 0L7 5.878 5.104 7.506a.665.665 0 0 1-.867.001L2.331 5.878.434 7.506a.66.66 0 0 1-.485.16.66.66 0 0 1-.53-.338.665.665 0 0 1 .147-.834l2.33-2a.666.666 0 0 1 .867 0L4.67 6.123l1.897-1.629a.666.666 0 0 1 .868 0l1.897 1.629 1.906-1.63a.668.668 0 0 1 .867.002l2.33 2a.66.66 0 0 1 .23.455.661.661 0 0 1-.252.575.666.666 0 0 1-.846-.019l-1.897-1.628z",transform:"translate(1 2)"}),v||(v=D.createElement("defs",null,D.createElement("path",{id:"break_svg__a",d:"M0 0h16v16H0z"}))))};function ei(){return(ei=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var eo=function(e){return D.createElement("svg",ei({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),D.createElement("g",null,x||(x=D.createElement("mask",{id:"chat-settings_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#chat-settings_svg__a"}))),D.createElement("g",{mask:"url(#chat-settings_svg__b)"},D.createElement("path",{style:{fill:"#333",opacity:1},d:"M6.728 14.598a.665.665 0 0 1-.828.434 7.294 7.294 0 0 1-3.187-1.945.666.666 0 0 1-.026-.896c.207-.241.31-.527.31-.857 0-.37-.13-.685-.389-.944A1.286 1.286 0 0 0 1.663 10h-.08a.662.662 0 0 1-.665-.288.665.665 0 0 1-.098-.235 7.234 7.234 0 0 1 .188-3.675.662.662 0 0 1 .635-.465h.02c.37 0 .684-.13.944-.392.26-.26.39-.574.39-.942 0-.215-.045-.415-.134-.6a.666.666 0 0 1 .148-.78A7.292 7.292 0 0 1 6.034.932a.666.666 0 0 1 .774.34c.11.219.272.394.483.524.216.135.454.202.712.202.254 0 .488-.067.703-.201.211-.131.372-.306.483-.524a.666.666 0 0 1 .773-.34 7.404 7.404 0 0 1 3.03 1.688.664.664 0 0 1 .143.8c-.09.174-.135.368-.135.583 0 .366.13.68.392.941.262.262.575.393.941.393h.03a.664.664 0 0 1 .636.465c.22.695.331 1.43.331 2.201a7.34 7.34 0 0 1-.143 1.474.66.66 0 0 1-.27.411.666.666 0 0 1-.478.115 1 1 0 0 0-.106-.003c-.367 0-.681.13-.941.39-.261.26-.392.574-.392.943 0 .322.106.61.317.865a.662.662 0 0 1 .1.686.671.671 0 0 1-.133.202 7.294 7.294 0 0 1-3.187 1.945.674.674 0 0 1-.503-.047.659.659 0 0 1-.325-.387 1.311 1.311 0 0 0-.477-.667 1.288 1.288 0 0 0-.789-.26c-.297 0-.564.087-.798.26-.23.17-.389.393-.477.667zm3.52-1.032c.626-.253 1.191-.6 1.696-1.042a2.603 2.603 0 0 1-.277-1.19 2.642 2.642 0 0 1 .784-1.888 2.646 2.646 0 0 1 1.51-.753 6.393 6.393 0 0 0-.118-2.067 2.655 2.655 0 0 1-1.394-.738 2.656 2.656 0 0 1-.782-1.884c0-.239.029-.468.087-.687a6.05 6.05 0 0 0-1.693-.954c-.182.22-.398.41-.65.566-.431.268-.9.402-1.408.402-.511 0-.983-.134-1.414-.401a2.632 2.632 0 0 1-.653-.567 5.936 5.936 0 0 0-1.69.957 2.74 2.74 0 0 1-.125 1.72c-.134.319-.324.601-.57.847a2.641 2.641 0 0 1-1.389.738 5.903 5.903 0 0 0-.12 2.069 2.642 2.642 0 0 1 1.509.753 2.654 2.654 0 0 1 .779 1.888c0 .433-.091.831-.274 1.192.504.44 1.068.787 1.692 1.04.172-.272.393-.507.664-.707.47-.348 1-.522 1.591-.522.587 0 1.115.174 1.584.523.27.2.49.435.661.705z"}),D.createElement("path",{style:{fill:"#333",opacity:1},d:"M10.122 10.122a2.987 2.987 0 0 1-2.125.881 2.969 2.969 0 0 1-2.122-.883 2.983 2.983 0 0 1-.64-.955A2.984 2.984 0 0 1 5 7.997a2.974 2.974 0 0 1 .876-2.12A2.974 2.974 0 0 1 7.996 5c.407 0 .797.078 1.169.235.36.151.678.364.955.64a2.969 2.969 0 0 1 .883 2.122 2.987 2.987 0 0 1-.881 2.125zM7.997 6.333c-.461 0-.854.162-1.178.486a1.603 1.603 0 0 0-.486 1.178c0 .462.163.857.488 1.183.324.327.716.49 1.176.49.46 0 .855-.164 1.182-.491.327-.327.491-.721.491-1.182 0-.46-.163-.852-.49-1.176a1.618 1.618 0 0 0-1.183-.488z"}))),w||(w=D.createElement("defs",null,D.createElement("path",{id:"chat-settings_svg__a",d:"M0 0h16v16H0z"}))))},ec=a(86224);function em(){return(em=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var ed=function(e){return D.createElement("svg",em({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),D.createElement("g",null,_||(_=D.createElement("mask",{id:"pin_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#pin_svg__a"}))),D.createElement("g",{mask:"url(#pin_svg__b)"},D.createElement("path",{style:{fill:"#333",opacity:1},d:"m6.685 8.81-4 5.44-.537-.394-.397-.536 5.42-4.01a.666.666 0 0 1 .866.062l.532.528 2.07 2.063-.471.473-.472-.472c.3-.3.457-.62.472-.963.015-.353-.108-.798-.37-1.333a.665.665 0 0 1 .017-.616l2.36-4.25a.662.662 0 0 1 .679-.336l1.65.24-.096.66-.472.471-3.77-3.77.472-.471.66-.096.24 1.65a.664.664 0 0 1-.337.678l-4.25 2.36a.665.665 0 0 1-.646.001c-.479-.265-.903-.388-1.27-.369-.358.018-.69.18-.996.487l-.471-.471.471-.472 2.06 2.06.52.52a.665.665 0 0 1 .066.867zM5.61 8.02l.537.396-.472.471-.52-.52-2.06-2.06a.665.665 0 0 1 0-.943c.548-.548 1.172-.84 1.87-.875.622-.032 1.283.146 1.984.533l-.322.584-.324-.583 4.25-2.36.324.583-.66.096-.24-1.65a.664.664 0 0 1 .66-.763.665.665 0 0 1 .471.195l3.77 3.77a.666.666 0 0 1-.567 1.131l-1.65-.24.096-.66.583.324-2.36 4.25-.583-.323.599-.293c.36.738.527 1.396.503 1.974-.029.689-.316 1.305-.86 1.85a.664.664 0 0 1-.842.083.667.667 0 0 1-.101-.082l-2.068-2.062-.531-.527.47-.473.396.535-5.42 4.01a.663.663 0 0 1-.791.002.664.664 0 0 1-.142-.932z"}))),k||(k=D.createElement("defs",null,D.createElement("path",{id:"pin_svg__a",d:"M0 0h16v16H0z"}))))},eh=a(2137),eu=a(21033);function eg(){return(eg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var ep=function(e){return D.createElement("svg",eg({xmlns:"http://www.w3.org/2000/svg",fill:"none",height:16,width:16,xmlSpace:"preserve"},e),y||(y=D.createElement("rect",{width:"100%",height:"100%"})),j||(j=D.createElement("g",{className:"image_svg__currentLayer"},D.createElement("g",{fill:"#333"},D.createElement("path",{d:"M2.47 2.47h1.977v-.782H1.688v2.76h.781zM11.553 1.688v.781h1.978v1.978h.78V1.688zM13.53 13.53h-1.977v.782h2.759v-2.76h-.781zM2.47 11.553h-.782v2.759h2.76v-.781H2.468zM8.83 6.243c.682 0 1.237-.555 1.237-1.236S9.512 3.77 8.83 3.77a1.238 1.238 0 0 0 0 2.473zM3.77 12.23h8.46V9.71l-1.527-1.611-1.85 1.077-2.578-1.842L3.77 9.977z"})))))};function ef(){return(ef=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var ev=function(e){return D.createElement("svg",ef({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),E||(E=D.createElement("defs",null,D.createElement("path",{id:"light_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,b||(b=D.createElement("mask",{id:"light_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#light_svg__a"}))),D.createElement("g",{mask:"url(#light_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M8.67 4.33C8.67 1.94 6.73 0 4.33 0 1.94 0 0 1.94 0 4.33a4.334 4.334 0 1 0 8.67 0Z",transform:"translate(3.667 3.667)"}),D.createElement("path",{fillRule:"evenodd",style:{fill:"#333"},d:"M1.67.83C1.67.37 1.29 0 .83 0 .37 0 0 .37 0 .83c0 .46.37.84.83.84.46 0 .84-.38.84-.84Z",transform:"translate(7.167 .333)"}),D.createElement("path",{fillRule:"evenodd",style:{fill:"#333"},d:"M1.67.83C1.67.37 1.29 0 .83 0 .37 0 0 .37 0 .83c0 .46.37.84.83.84.46 0 .84-.38.84-.84Z",transform:"translate(12 2.333)"}),D.createElement("path",{fillRule:"evenodd",style:{fill:"#333"},d:"M1.67.83C1.67.37 1.29 0 .83 0 .37 0 0 .37 0 .83c0 .46.37.84.83.84.46 0 .84-.38.84-.84Z",transform:"translate(14 7.167)"}),D.createElement("path",{fillRule:"evenodd",style:{fill:"#333"},d:"M1.67.83C1.67.37 1.29 0 .83 0 .37 0 0 .37 0 .83c0 .46.37.84.83.84.46 0 .84-.38.84-.84Z",transform:"translate(12 12)"}),D.createElement("path",{fillRule:"evenodd",style:{fill:"#333"},d:"M1.67.83C1.67.37 1.29 0 .83 0 .37 0 0 .37 0 .83c0 .46.37.84.83.84.46 0 .84-.38.84-.84Z",transform:"translate(7.167 14)"}),D.createElement("path",{fillRule:"evenodd",style:{fill:"#333"},d:"M1.67.83C1.67.37 1.29 0 .83 0 .37 0 0 .37 0 .83c0 .46.37.84.83.84.46 0 .84-.38.84-.84Z",transform:"translate(2.333 12)"}),D.createElement("path",{fillRule:"evenodd",style:{fill:"#333"},d:"M1.67.83C1.67.37 1.29 0 .83 0 .37 0 0 .37 0 .83c0 .46.37.84.83.84.46 0 .84-.38.84-.84Z",transform:"translate(.333 7.167)"}),D.createElement("path",{fillRule:"evenodd",style:{fill:"#333"},d:"M1.67.83C1.67.37 1.29 0 .83 0 .37 0 0 .37 0 .83c0 .46.37.84.83.84.46 0 .84-.38.84-.84Z",transform:"translate(2.333 2.333)"}))))};function ex(){return(ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var ew=function(e){return D.createElement("svg",ex({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),C||(C=D.createElement("defs",null,D.createElement("path",{id:"dark_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,S||(S=D.createElement("mask",{id:"dark_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#dark_svg__a"}))),D.createElement("g",{mask:"url(#dark_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M6.67 0C2.98 0 0 2.98 0 6.67a6.66 6.66 0 0 0 6.67 6.66c3.68 0 6.66-2.98 6.66-6.66 0-.47-.04-.92-.13-1.35a4.251 4.251 0 0 1-4.11 3.16c-2.34 0-4.24-1.89-4.24-4.24 0-1.97 1.34-3.63 3.17-4.1C7.58.05 7.13 0 6.67 0Z",transform:"translate(1.333 1.333)"}))))};function e_(){return(e_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var ek=function(e){return D.createElement("svg",e_({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),M||(M=D.createElement("defs",null,D.createElement("path",{id:"auto_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,P||(P=D.createElement("mask",{id:"auto_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#auto_svg__a"}))),D.createElement("g",{mask:"url(#auto_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1,strokeOpacity:1,strokeDasharray:"0 0"},d:"m0 5.337.73-1.67m3.938 1.67-.73-1.67M.728 3.67 2.33 0l1.61 3.67M.73 3.667h3.21",transform:"translate(5.667 5.333)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M13.07 5.33A6.672 6.672 0 0 0 0 5.33l2-.66",transform:"translate(1.333 1.333)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M0 0a6.672 6.672 0 0 0 13.07 0l-1.74.67",transform:"translate(1.333 9.333)"}))))};function ey(){return(ey=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var ej=function(e){return D.createElement("svg",ey({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),N||(N=D.createElement("defs",null,D.createElement("path",{id:"bottom_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,O||(O=D.createElement("mask",{id:"bottom_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#bottom_svg__a"}))),D.createElement("g",{mask:"url(#bottom_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M8 0 4 4 0 0",transform:"translate(4 4)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M8 0 4 4 0 0",transform:"translate(4 8)"}))))};function eE(){return(eE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var eb=function(e){return D.createElement("svg",eE({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),Z||(Z=D.createElement("defs",null,D.createElement("path",{id:"pause_svg__a",d:"M0 0h16v16H0z"}))),D.createElement("g",null,A||(A=D.createElement("mask",{id:"pause_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#pause_svg__a"}))),D.createElement("g",{mask:"url(#pause_svg__b)"},D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M13.33 6.67A6.66 6.66 0 0 0 6.67 0C2.98 0 0 2.98 0 6.67a6.66 6.66 0 0 0 6.67 6.66c3.68 0 6.66-2.98 6.66-6.66Z",transform:"translate(1.333 1.333)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M0 0v4",transform:"translate(6.333 6)"}),D.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},d:"M0 0v4",transform:"translate(9.667 6)"}))))};function eC(){return(eC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var eS=function(e){return D.createElement("svg",eC({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),D.createElement("g",null,H||(H=D.createElement("mask",{id:"robot_svg__b",fill:"#fff"},D.createElement("use",{xlinkHref:"#robot_svg__a"}))),D.createElement("g",{mask:"url(#robot_svg__b)"},D.createElement("path",{style:{fill:"#333",opacity:1},d:"M3.67 13.67h8.66c.002 0 .003-.001.003-.003V6.334H3.67c-.002 0-.003 0-.003.003v7.33c0 .002 0 .003.003.003zm0 1.333c-.37 0-.684-.13-.945-.391a1.288 1.288 0 0 1-.392-.945v-7.33c0-.37.13-.685.392-.946.26-.26.576-.391.945-.391h8.66c.37 0 .684.13.945.391.261.261.392.577.392.946v7.33c0 .369-.13.684-.392.945a1.288 1.288 0 0 1-.945.391z"}),D.createElement("path",{style:{fill:"#333",opacity:1},d:"M9.819 6.127a.666.666 0 0 1-1.05-.81l1.67-2.67a.665.665 0 0 1 1.107-.034.663.663 0 0 1 .023.74l-1.67 2.67a.665.665 0 0 1-.08.104zM7.293 5.434a.665.665 0 0 1-1.01.779.665.665 0 0 1-.178-.19l-1.67-2.67a.665.665 0 0 1 .952-.896.665.665 0 0 1 .178.19l1.67 2.67a.665.665 0 0 1 .058.117z"}),D.createElement("path",{style:{fill:"#333",opacity:1},d:"M11.337 2.333c-.003 0-.004.001-.004.004l-.001-.01a.007.007 0 0 0 .005.003h-.007v.007c0-.002 0-.004-.002-.005l.009.001zm0-1.333c.366 0 .679.131.939.394.258.261.387.575.387.943 0 .364-.13.676-.39.936s-.572.39-.936.39c-.368 0-.682-.129-.943-.388A1.273 1.273 0 0 1 10 2.337c0-.37.13-.685.391-.946.262-.26.577-.391.946-.391zM4.67 2.333c-.002 0-.003.001-.003.004 0-.005 0-.008-.002-.01a.007.007 0 0 0 .005.003h-.006v.007c0-.002-.001-.004-.003-.005l.009.001zM4.67 1c.366 0 .679.131.939.394.258.261.388.575.388.943 0 .364-.13.676-.39.936s-.573.39-.937.39c-.367 0-.681-.129-.943-.388a1.273 1.273 0 0 1-.394-.938c0-.37.13-.685.392-.946.26-.26.576-.391.945-.391zM6.663 10.003h2.67c.184 0 .34-.065.469-.194a.655.655 0 0 0 .195-.479.638.638 0 0 0-.196-.467.638.638 0 0 0-.468-.196h-2.67a.638.638 0 0 0-.467.196A.638.638 0 0 0 6 9.33c0 .188.065.347.195.479.128.13.284.194.468.194zm0 1.334a1.974 1.974 0 0 1-1.416-.59 2.001 2.001 0 0 1 1.416-3.413h2.67a1.99 1.99 0 0 1 1.41.587 1.99 1.99 0 0 1 .587 1.409 2.002 2.002 0 0 1-1.997 2.007zM2 10.663h1.003a.666.666 0 1 1 0 1.334h-1.67a.666.666 0 0 1-.666-.667V8a.665.665 0 0 1 .666-.667h1.67a.665.665 0 0 1 .555 1.037.665.665 0 0 1-.555.297H2zM14.8 7.346a.664.664 0 0 1 .537.654v3.33a.666.666 0 0 1-.667.667H13a.666.666 0 1 1 0-1.334h1.003V8.667H13a.665.665 0 0 1-.471-1.138.664.664 0 0 1 .471-.196h1.67c.044 0 .087.005.13.013z"}))),T||(T=D.createElement("defs",null,D.createElement("path",{id:"robot_svg__a",d:"M0 0h16v16H0z"}))))},eM=a(79724),eP=a(9881),eN=a(25952),eO=a.n(eN),eZ=a(97799),eA=a(3566),eH=a(1405),eT=a(48),eI=a(54461),ez=a.n(eI),eD=a(19319),eK=a(17005),eF=a(72908),eL=a(16778),eR=a(28029),eB=a(22852),eW=a(26640),eU=a(75008),eG=a(56963),eX=a.n(eG),eY=a(68961),eQ={src:"/_next/static/media/bot.0c800005.png",height:120,width:120,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJFBMVEXw/P/n+f7n+P3H6Ozm+v/s/v7j9f6b0tSKycq44OT+//96wcAo613LAAAAB3RSTlP8s/78Ghwcspe7uQAAAAlwSFlzAAALEwAACxMBAJqcGAAAADRJREFUeJxFyjECwCAMA7FzgNqB//+XgaGbBjFFgSbawx5b0MdJQzl2DDwUdOLT/HkJqvRdKxgBNia5OmYAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},eV=a(33186),eJ=a(25106),eq=a.n(eJ);function e$(e){let t=(0,eM.aK)(),a=t.currentSession(),n=e=>e.content&&!e.isError&&!e.streaming,s=(0,D.useMemo)(()=>{var e;let t=Math.max(0,null!==(e=a.clearContextIndex)&&void 0!==e?e:0);return t===a.messages.length-1&&(t=0),a.messages.slice(t)},[a.messages,a.clearContextIndex]),r=(0,D.useMemo)(()=>s.filter((e,t)=>e.id&&n(e)&&(t>=s.length-1||n(s[t+1]))),[s]),l=r.length,i=(0,eM.MG)(),[o,c]=(0,D.useState)(""),[m,d]=(0,D.useState)(new Set),h=e=>0===o.length||m.has(e),u=e=>{let t=new Set;e.length>0&&r.forEach(a=>(0,eP.YK)(a).includes(e)?t.add(a.id):null),d(t)},{startIndex:g,endIndex:p,onClickIndex:f}=function(){let[e,t]=(0,D.useState)(),[a,n]=(0,D.useState)(),[s,r]=(0,D.useState)(!1);return(0,D.useEffect)(()=>{let e=e=>{"Shift"===e.key&&r(!0)},a=e=>{"Shift"===e.key&&(r(!1),t(void 0),n(void 0))};return window.addEventListener("keyup",a),window.addEventListener("keydown",e),()=>{window.removeEventListener("keyup",a),window.removeEventListener("keydown",e)}},[]),{onClickIndex:a=>{s&&void 0!==e?n(a):(t(a),n(void 0))},startIndex:e,endIndex:a}}(),v=()=>{e.updateSelection(e=>r.forEach(t=>e.add(t.id)))};return(0,D.useEffect)(()=>{e.defaultSelectAll&&v()},[]),(0,D.useEffect)(()=>{if(void 0===g||void 0===p)return;let[t,a]=[g,p].sort((e,t)=>e-t);e.updateSelection(e=>{for(let s=t;s<=a;s+=1){var n;e.add(null!==(n=r[s].id)&&void 0!==n?n:s)}})},[g,p]),(0,I.jsxs)("div",{className:eq()["message-selector"],children:[(0,I.jsxs)("div",{className:eq()["message-filter"],children:[(0,I.jsx)("input",{type:"text",placeholder:eH.ZP.Select.Search,className:eq()["filter-item"]+" "+eq()["search-bar"],value:o,onInput:e=>{c(e.currentTarget.value),u(e.currentTarget.value)}}),(0,I.jsxs)("div",{className:eq().actions,children:[(0,I.jsx)(eT.h,{text:eH.ZP.Select.All,bordered:!0,className:eq()["filter-item"],onClick:v}),(0,I.jsx)(eT.h,{text:eH.ZP.Select.Latest,bordered:!0,className:eq()["filter-item"],onClick:()=>e.updateSelection(e=>{e.clear(),r.slice(l-4).forEach(t=>e.add(t.id))})}),(0,I.jsx)(eT.h,{text:eH.ZP.Select.Clear,bordered:!0,className:eq()["filter-item"],onClick:()=>e.updateSelection(e=>e.clear())})]})]}),(0,I.jsx)("div",{className:eq().messages,children:r.map((t,n)=>{var s;if(!h(t.id))return null;let r=null!==(s=t.id)&&void 0!==s?s:n,l=e.selection.has(r);return(0,I.jsxs)("div",{className:"".concat(eq().message," ").concat(e.selection.has(t.id)&&eq()["message-selected"]),onClick:()=>{e.updateSelection(e=>{e.has(r)?e.delete(r):e.add(r)}),f(n)},children:[(0,I.jsx)("div",{className:eq().avatar,children:"user"===t.role?(0,I.jsx)(eL.qE,{avatar:i.avatar}):(0,I.jsx)(eR.MaskAvatar,{avatar:a.mask.avatar,model:t.model||a.mask.modelConfig.model})}),(0,I.jsxs)("div",{className:eq().body,children:[(0,I.jsx)("div",{className:eq().date,children:new Date(t.date).toLocaleString()}),(0,I.jsx)("div",{className:"".concat(eq().content," one-line"),children:(0,eP.YK)(t)})]}),(0,I.jsx)("div",{className:eq().checkbox,children:(0,I.jsx)("input",{type:"checkbox",checked:l})})]},n)})})]})}var e0=a(76394),e3=a.n(e0),e1=a(84262),e6=a(41881),e2=a(10244);let e7=eO()(async()=>(await Promise.all([a.e(327),a.e(9638),a.e(9015),a.e(3769)]).then(a.bind(a,85636))).Markdown,{loadableGenerated:{webpack:()=>[85636]},loading:()=>(0,I.jsx)(V.Z,{})});function e4(e){return(0,I.jsx)("div",{className:"modal-mask",children:(0,I.jsx)(eD.u_,{title:eH.ZP.Export.Title,onClose:e.onClose,footer:(0,I.jsx)("div",{style:{width:"100%",textAlign:"center",fontSize:14,opacity:.5},children:eH.ZP.Exporter.Description.Title}),children:(0,I.jsx)("div",{style:{minHeight:"40vh"},children:(0,I.jsx)(e9,{})})})})}function e8(e){let t=e.steps,a=t.length;return(0,I.jsxs)("div",{className:eX().steps,children:[(0,I.jsx)("div",{className:eX()["steps-progress"],children:(0,I.jsx)("div",{className:eX()["steps-progress-inner"],style:{width:"".concat((e.index+1)/a*100,"%")}})}),(0,I.jsx)("div",{className:eX()["steps-inner"],children:t.map((t,a)=>(0,I.jsxs)("div",{className:"".concat(eX().step," ").concat(eX()[a<=e.index?"step-finished":""]," ").concat(a===e.index&&eX()["step-current"]," clickable"),onClick:()=>{var t;null===(t=e.onStepChange)||void 0===t||t.call(e,a)},role:"button",children:[(0,I.jsx)("span",{className:eX()["step-index"],children:a+1}),(0,I.jsx)("span",{className:eX()["step-name"],children:t.name})]},a))})]})}function e9(){let e=[{name:eH.ZP.Export.Steps.Select,value:"select"},{name:eH.ZP.Export.Steps.Preview,value:"preview"}],{currentStep:t,setCurrentStepIndex:a,currentStepIndex:n}=function(e){let t=e.length,[a,n]=(0,D.useState)(0);return{currentStepIndex:a,setCurrentStepIndex:n,nextStep:()=>n((a+1)%t),prevStep:()=>n((a-1+t)%t),currentStep:e[a]}}(e),[s,r]=(0,D.useState)({format:"image",includeContext:!0});function l(e){let t={...s};e(t),r(t)}let i=(0,eM.aK)(),o=i.currentSession(),{selection:c,updateSelection:m}=function(){let[e,t]=(0,D.useState)(new Set);return{selection:e,updateSelection:a=>{let n=new Set(e);a(n),t(n)}}}(),d=(0,D.useMemo)(()=>{let e=[];return s.includeContext&&e.push(...o.mask.context),e.push(...o.messages.filter(e=>c.has(e.id))),e},[s.includeContext,o.messages,o.mask.context,c]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(e8,{steps:e,index:n,onStepChange:a}),(0,I.jsxs)("div",{className:eX()["message-exporter-body"],style:"select"!==t.value?{display:"none"}:{},children:[(0,I.jsxs)(eD.aV,{children:[(0,I.jsx)(eD.HC,{title:eH.ZP.Export.Format.Title,subTitle:eH.ZP.Export.Format.SubTitle,children:(0,I.jsx)(eD.Ph,{value:s.format,onChange:e=>l(t=>t.format=e.currentTarget.value),children:["text","image","json"].map(e=>(0,I.jsx)("option",{value:e,children:e},e))})}),(0,I.jsx)(eD.HC,{title:eH.ZP.Export.IncludeContext.Title,subTitle:eH.ZP.Export.IncludeContext.SubTitle,children:(0,I.jsx)("input",{type:"checkbox",checked:s.includeContext,onChange:e=>{l(t=>t.includeContext=e.currentTarget.checked)}})})]}),(0,I.jsx)(e$,{selection:c,updateSelection:m,defaultSelectAll:!0})]}),"preview"===t.value&&(0,I.jsx)("div",{className:eX()["message-exporter-body"],children:"text"===s.format?(0,I.jsx)(tn,{messages:d,topic:o.topic}):"json"===s.format?(0,I.jsx)(ts,{messages:d,topic:o.topic}):(0,I.jsx)(ta,{messages:d,topic:o.topic})})]})}function e5(e){let t=(0,D.useRef)(null);return(0,D.useEffect)(()=>{if(!t.current)return;let a=t.current,n=Array.from(a.getElementsByClassName(eF.yY));if(n.length!==e.messages.length)return;let s=n.map((e,t)=>{var a;let[n,s]=e.id.split(":");return{id:t.toString(),role:n,content:"user"===n?null!==(a=e.textContent)&&void 0!==a?a:"":e.innerHTML,date:""}});e.onRender(s)},[]),(0,I.jsx)("div",{ref:t,children:e.messages.map((e,t)=>(0,I.jsx)("div",{id:"".concat(e.role,":").concat(t),className:eF.yY,children:(0,I.jsx)(e7,{content:(0,eP.YK)(e),defaultShow:!0})},t))})}function te(e){var t;let[a,n]=(0,D.useState)(!1),[s,r]=(0,D.useState)(!1),l=(0,eM.MG)(),i=async()=>{var t;(null===(t=e.messages)||void 0===t?void 0:t.length)&&(n(!0),r(!0))};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:eX()["preview-actions"],children:[e.showCopy&&(0,I.jsx)(eT.h,{text:eH.ZP.Export.Copy,bordered:!0,shadow:!0,icon:(0,I.jsx)(Q.Z,{}),onClick:e.copy}),(0,I.jsx)(eT.h,{text:eH.ZP.Export.Download,bordered:!0,shadow:!0,icon:(0,I.jsx)(eV.Z,{}),onClick:e.download}),(0,I.jsx)(eT.h,{text:eH.ZP.Export.Share,bordered:!0,shadow:!0,icon:a?(0,I.jsx)(V.Z,{}):(0,I.jsx)(G,{}),onClick:i})]}),(0,I.jsx)("div",{style:{position:"fixed",right:"200vw",pointerEvents:"none"},children:s&&(0,I.jsx)(e5,{messages:null!==(t=e.messages)&&void 0!==t?t:[],onRender:e=>{r(!1),new e2.ti(l.modelConfig.model.startsWith("gemini")?eF.k8.GeminiPro:eF.k8.GPT).share(e).then(e=>{e&&((0,eD.K4)({title:eH.ZP.Export.Share,children:[(0,I.jsx)("input",{type:"text",value:e,style:{width:"100%",maxWidth:"unset"},readOnly:!0,onClick:e=>e.currentTarget.select()},"input")],actions:[(0,I.jsx)(eT.h,{icon:(0,I.jsx)(Q.Z,{}),text:eH.ZP.Chat.Actions.Copy,onClick:()=>(0,eP.vQ)(e)},"copy")]}),setTimeout(()=>{window.open(e,"_blank")},800))}).catch(e=>{console.error("[Share]",e),(0,eD.CF)((0,eU.B)(e))}).finally(()=>n(!1))}})})]})}function tt(e){return e.avatar===eB._G?(0,I.jsx)("img",{src:eQ.src,width:30,height:30,alt:"bot",className:"user-avatar"}):(0,I.jsx)(eL.qE,{avatar:e.avatar})}function ta(e){var t,a;let n=(0,eM.aK)(),s=n.currentSession(),r=s.mask,l=(0,eM.MG)(),i=(0,D.useRef)(null),o=(0,eP.S0)(),c=async()=>{var t;(0,eD.CF)(eH.ZP.Export.Image.Toast);let a=i.current;if(!a)return;let n=null===(t=(0,e6.Z)())||void 0===t?void 0:t.isApp;try{let t=await (0,e1.YM)(a);if(!t)return;if(o||n&&window.__TAURI__){if(n&&window.__TAURI__){let a=await window.__TAURI__.dialog.save({defaultPath:"".concat(e.topic,".png"),filters:[{name:"PNG Files",extensions:["png"]},{name:"All Files",extensions:["*"]}]});if(null!==a){let e=await fetch(t),n=await e.arrayBuffer(),s=new Uint8Array(n);await window.__TAURI__.fs.writeBinaryFile(a,s),(0,eD.CF)(eH.ZP.Download.Success)}else(0,eD.CF)(eH.ZP.Download.Failed)}else(0,eD.vi)(t)}else{let a=document.createElement("a");a.download="".concat(e.topic,".png"),a.href=t,a.click(),m()}}catch(e){(0,eD.CF)(eH.ZP.Download.Failed)}},m=()=>{let e=i.current;e&&(e.innerHTML=e.innerHTML)};return(0,I.jsxs)("div",{className:eX()["image-previewer"],children:[(0,I.jsx)(te,{copy:()=>{(0,eD.CF)(eH.ZP.Export.Image.Toast);let e=i.current;e&&(0,e1.SE)(e).then(e=>{if(e)try{navigator.clipboard.write([new ClipboardItem({"image/png":e})]).then(()=>{(0,eD.CF)(eH.ZP.Copy.Success),m()})}catch(e){console.error("[Copy Image] ",e),(0,eD.CF)(eH.ZP.Copy.Failed)}})},download:c,showCopy:!o,messages:e.messages}),(0,I.jsxs)("div",{className:"".concat(eX()["preview-body"]," ").concat(eX()["default-theme"]),ref:i,children:[(0,I.jsxs)("div",{className:eX()["chat-info"],children:[(0,I.jsx)("div",{className:eX().logo+" no-dark",children:(0,I.jsx)(e3(),{src:eY.Z.src,alt:"logo",width:50,height:50})}),(0,I.jsxs)("div",{children:[(0,I.jsx)("div",{className:eX()["main-title"],children:"Serena"}),(0,I.jsx)("div",{className:eX()["sub-title"],children:"github.com/Yidadaa/ChatGPT-Next-Web"}),(0,I.jsxs)("div",{className:eX().icons,children:[(0,I.jsx)(tt,{avatar:l.avatar}),(0,I.jsx)("span",{className:eX()["icon-space"],children:"&"}),(0,I.jsx)(tt,{avatar:r.avatar})]})]}),(0,I.jsxs)("div",{children:[(0,I.jsxs)("div",{className:eX()["chat-info-item"],children:[eH.ZP.Exporter.Model,": ",r.modelConfig.model]}),(0,I.jsxs)("div",{className:eX()["chat-info-item"],children:[eH.ZP.Exporter.Messages,": ",e.messages.length]}),(0,I.jsxs)("div",{className:eX()["chat-info-item"],children:[eH.ZP.Exporter.Topic,": ",s.topic]}),(0,I.jsxs)("div",{className:eX()["chat-info-item"],children:[eH.ZP.Exporter.Time,":"," ",new Date(null!==(a=null===(t=e.messages.at(-1))||void 0===t?void 0:t.date)&&void 0!==a?a:Date.now()).toLocaleString()]})]})]}),e.messages.map((e,t)=>(0,I.jsxs)("div",{className:eX().message+" "+eX()["message-"+e.role],children:[(0,I.jsx)("div",{className:eX().avatar,children:(0,I.jsx)(tt,{avatar:"user"===e.role?l.avatar:r.avatar})}),(0,I.jsxs)("div",{className:eX().body,children:[(0,I.jsx)(e7,{content:(0,eP.YK)(e),fontSize:l.fontSize,defaultShow:!0}),1==(0,eP.Bs)(e).length&&(0,I.jsx)("img",{src:(0,eP.Bs)(e)[0],alt:"message",className:eX()["message-image"]},t),(0,eP.Bs)(e).length>1&&(0,I.jsx)("div",{className:eX()["message-images"],style:{"--image-count":(0,eP.Bs)(e).length},children:(0,eP.Bs)(e).map((e,t)=>(0,I.jsx)("img",{src:e,alt:"message",className:eX()["message-image-multi"]},t))})]})]},t))]})]})}function tn(e){let t="# ".concat(e.topic,"\n\n")+e.messages.map(e=>"user"===e.role?"## ".concat(eH.ZP.Export.MessageFromYou,":\n").concat((0,eP.YK)(e)):"## ".concat(eH.ZP.Export.MessageFromChatGPT,":\n").concat((0,eP.YK)(e).trim())).join("\n\n");return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(te,{copy:()=>{(0,eP.vQ)(t)},download:()=>{(0,eP.CP)(t,"".concat(e.topic,".md"))},showCopy:!0,messages:e.messages}),(0,I.jsx)("div",{className:"markdown-body",children:(0,I.jsx)("pre",{className:eX()["export-content"],children:t})})]})}function ts(e){let t={messages:[{role:"system",content:"".concat(eH.ZP.FineTuned.Sysmessage," ").concat(e.topic)},...e.messages.map(e=>({role:e.role,content:e.content}))]},a="```json\n"+JSON.stringify(t,null,2)+"\n```",n=JSON.stringify(t),s=()=>{(0,eP.vQ)(n)};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(te,{copy:s,download:()=>{(0,eP.CP)(JSON.stringify(t),"".concat(e.topic,".json"))},showCopy:!1,messages:e.messages}),(0,I.jsx)("div",{className:"markdown-body",onClick:s,children:(0,I.jsx)(e7,{content:a})})]})}var tr=a(38997);let tl=eO()(async()=>(await Promise.all([a.e(327),a.e(9638),a.e(9015),a.e(3769)]).then(a.bind(a,85636))).Markdown,{loadableGenerated:{webpack:()=>[85636]},loading:()=>(0,I.jsx)(V.Z,{})});function ti(e){let t=(0,eM.aK)(),a=t.currentSession(),n=(0,eB.Zy)(),s=(0,eK.s0)();return(0,I.jsx)("div",{className:"modal-mask",children:(0,I.jsx)(eD.u_,{title:eH.ZP.Context.Edit,onClose:()=>e.onClose(),actions:[(0,I.jsx)(eT.h,{icon:(0,I.jsx)(es.Z,{}),bordered:!0,text:eH.ZP.Chat.Config.Reset,onClick:async()=>{await (0,eD.i0)(eH.ZP.Memory.ResetConfirm)&&t.updateCurrentSession(e=>e.memoryPrompt="")}},"reset"),(0,I.jsx)(eT.h,{icon:(0,I.jsx)(Q.Z,{}),bordered:!0,text:eH.ZP.Chat.Config.SaveAs,onClick:()=>{s(eF.y$.Masks),setTimeout(()=>{n.create(a.mask)},500)}},"copy")],children:(0,I.jsx)(eR.MaskConfig,{mask:a.mask,updateMask:e=>{let n={...a.mask};e(n),t.updateCurrentSession(e=>e.mask=n)},shouldSyncFromGlobal:!0,extraListItems:a.mask.modelConfig.sendMemory?(0,I.jsx)(eD.HC,{className:"copyable",title:"".concat(eH.ZP.Memory.Title," (").concat(a.lastSummarizeIndex," of ").concat(a.messages.length,")"),subTitle:a.memoryPrompt||eH.ZP.Memory.EmptyContent}):(0,I.jsx)(I.Fragment,{})})})})}function to(e){let t=(0,eM.aK)(),a=t.currentSession(),n=a.mask.context;return(0,I.jsxs)("div",{className:ez()["prompt-toast"],children:[e.showToast&&(0,I.jsxs)("div",{className:ez()["prompt-toast-inner"]+" clickable",role:"button",onClick:()=>e.setShowModal(!0),children:[(0,I.jsx)(R,{}),(0,I.jsx)("span",{className:ez()["prompt-toast-content"],children:eH.ZP.Context.Toast(n.length)})]}),e.showModal&&(0,I.jsx)(ti,{onClose:()=>e.setShowModal(!1)})]},"prompt-toast")}function tc(e){let t=0===e.prompts.length,[a,n]=(0,D.useState)(0),s=(0,D.useRef)(null);return((0,D.useEffect)(()=>{n(0)},[e.prompts.length]),(0,D.useEffect)(()=>{let r=r=>{if(t||r.metaKey||r.altKey||r.ctrlKey)return;let l=t=>{var l;r.stopPropagation(),r.preventDefault();let i=Math.max(0,Math.min(e.prompts.length-1,a+t));n(i),null===(l=s.current)||void 0===l||l.scrollIntoView({block:"center"})};if("ArrowUp"===r.key)l(1);else if("ArrowDown"===r.key)l(-1);else if("Enter"===r.key){let t=e.prompts.at(a);t&&e.onPromptSelect(t)}};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[e.prompts.length,a]),t)?null:(0,I.jsx)("div",{className:ez()["prompt-hints"],children:e.prompts.map((t,r)=>(0,I.jsxs)("div",{ref:r===a?s:null,className:ez()["prompt-hint"]+" ".concat(r===a?ez()["prompt-hint-selected"]:""),onClick:()=>e.onPromptSelect(t),onMouseEnter:()=>n(r),children:[(0,I.jsx)("div",{className:ez()["hint-title"],children:t.title}),(0,I.jsx)("div",{className:ez()["hint-content"],children:t.content})]},t.title+r.toString()))})}function tm(){let e=(0,eM.aK)();return(0,I.jsxs)("div",{className:ez()["clear-context"],onClick:()=>e.updateCurrentSession(e=>e.clearContextIndex=void 0),children:[(0,I.jsx)("div",{className:ez()["clear-context-tips"],children:eH.ZP.Context.Clear}),(0,I.jsx)("div",{className:ez()["clear-context-revert-btn"],children:eH.ZP.Context.Revert})]})}function td(e){let t=(0,D.useRef)(null),a=(0,D.useRef)(null),[n,s]=(0,D.useState)({full:16,icon:16});function r(){if(!t.current||!a.current)return;let e=a.current.getBoundingClientRect().width,n=t.current.getBoundingClientRect().width;s({full:e+n,icon:n})}return(0,I.jsxs)("div",{className:"".concat(ez()["chat-input-action"]," clickable"),onClick:()=>{e.onClick(),setTimeout(r,1)},onMouseEnter:r,onTouchStart:r,style:{"--icon-width":"".concat(n.icon,"px"),"--full-width":"".concat(n.full,"px")},children:[(0,I.jsx)("div",{ref:t,className:ez().icon,children:e.icon}),(0,I.jsx)("div",{className:ez().text,ref:a,children:e.text})]})}function th(e){let t=(0,eM.MG)(),a=(0,eK.s0)(),n=(0,eM.aK)(),s=t.theme,r=eZ.L.hasPending(),l=n.currentSession().mask.modelConfig.model,i=(0,tr.l)(),o=(0,D.useMemo)(()=>i.filter(e=>e.available),[i]),[c,m]=(0,D.useState)(!1),[d,h]=(0,D.useState)(!1);return(0,D.useEffect)(()=>{let t=(0,eP.Xf)(l);h(t),t||(e.setAttachImages([]),e.setUploading(!1));let a=!o.some(e=>e.name===l);if(a&&o.length>0){let e=o[0].name;n.updateCurrentSession(t=>t.mask.modelConfig.model=e),(0,eD.CF)(e)}},[n,l,o]),(0,I.jsxs)("div",{className:ez()["chat-input-actions"],children:[r&&(0,I.jsx)(td,{onClick:()=>eZ.L.stopAll(),text:eH.ZP.Chat.InputActions.Stop,icon:(0,I.jsx)(eb,{})}),!e.hitBottom&&(0,I.jsx)(td,{onClick:e.scrollToBottom,text:eH.ZP.Chat.InputActions.ToBottom,icon:(0,I.jsx)(ej,{})}),e.hitBottom&&(0,I.jsx)(td,{onClick:e.showPromptModal,text:eH.ZP.Chat.InputActions.Settings,icon:(0,I.jsx)(eo,{})}),d&&(0,I.jsx)(td,{onClick:e.uploadImage,text:eH.ZP.Chat.InputActions.UploadImage,icon:e.uploading?(0,I.jsx)(q,{}):(0,I.jsx)(ep,{})}),(0,I.jsx)(td,{onClick:function(){let e=[eM.Q2.Auto,eM.Q2.Light,eM.Q2.Dark],a=e.indexOf(s),n=(a+1)%e.length,r=e[n];t.update(e=>e.theme=r)},text:eH.ZP.Chat.InputActions.Theme[s],icon:(0,I.jsx)(I.Fragment,{children:s===eM.Q2.Auto?(0,I.jsx)(ek,{}):s===eM.Q2.Light?(0,I.jsx)(ev,{}):s===eM.Q2.Dark?(0,I.jsx)(ew,{}):null})}),(0,I.jsx)(td,{onClick:e.showPromptHints,text:eH.ZP.Chat.InputActions.Prompt,icon:(0,I.jsx)(ee,{})}),(0,I.jsx)(td,{onClick:()=>{a(eF.y$.Masks)},text:eH.ZP.Chat.InputActions.Masks,icon:(0,I.jsx)(et.Z,{})}),(0,I.jsx)(td,{text:eH.ZP.Chat.InputActions.Clear,icon:(0,I.jsx)(el,{}),onClick:()=>{n.updateCurrentSession(e=>{e.clearContextIndex===e.messages.length?e.clearContextIndex=void 0:(e.clearContextIndex=e.messages.length,e.memoryPrompt="")})}}),(0,I.jsx)(td,{onClick:()=>m(!0),text:l,icon:(0,I.jsx)(eS,{})}),c&&(0,I.jsx)(eD.Qf,{defaultSelectedValue:l,items:o.map(e=>({title:e.displayName,value:e.name})),onClose:()=>m(!1),onSelection:e=>{0!==e.length&&(n.updateCurrentSession(t=>{t.mask.modelConfig.model=e[0],t.mask.syncGlobalConfig=!1}),(0,eD.CF)(e[0]))}})]})}function tu(e){let t=(0,eM.aK)(),a=t.currentSession(),[n,s]=(0,D.useState)(a.messages.slice());return(0,I.jsx)("div",{className:"modal-mask",children:(0,I.jsxs)(eD.u_,{title:eH.ZP.Chat.EditMessage.Title,onClose:e.onClose,actions:[(0,I.jsx)(eT.h,{text:eH.ZP.UI.Cancel,icon:(0,I.jsx)(eu.Z,{}),onClick:()=>{e.onClose()}},"cancel"),(0,I.jsx)(eT.h,{type:"primary",text:eH.ZP.UI.Confirm,icon:(0,I.jsx)(eh.Z,{}),onClick:()=>{t.updateCurrentSession(e=>e.messages=n),e.onClose()}},"ok")],children:[(0,I.jsx)(eD.aV,{children:(0,I.jsx)(eD.HC,{title:eH.ZP.Chat.EditMessage.Topic.Title,subTitle:eH.ZP.Chat.EditMessage.Topic.SubTitle,children:(0,I.jsx)("input",{type:"text",value:a.topic,onInput:e=>t.updateCurrentSession(t=>t.topic=e.currentTarget.value)})})}),(0,I.jsx)(eR.ContextPrompts,{context:n,updateContext:e=>{let t=n.slice();e(t),s(t)}})]})})}function tg(e){return(0,I.jsx)("div",{className:ez()["delete-image"],onClick:e.deleteImage,children:(0,I.jsx)(ec.Z,{})})}function tp(){var e,t;let a=(0,eM.aK)(),n=a.currentSession(),s=(0,eM.MG)(),r=s.fontSize,[l,i]=(0,D.useState)(!1),o=(0,D.useRef)(null),[c,m]=(0,D.useState)(""),[d,h]=(0,D.useState)(!1),{submitKey:u,shouldSubmit:g}=function(){let e=(0,eM.MG)(),t=e.submitKey,a=(0,D.useRef)(!1);return(0,D.useEffect)(()=>{let e=()=>{a.current=!0},t=()=>{a.current=!1};return window.addEventListener("compositionstart",e),window.addEventListener("compositionend",t),()=>{window.removeEventListener("compositionstart",e),window.removeEventListener("compositionend",t)}},[]),{submitKey:t,shouldSubmit:t=>"Enter"===t.key&&("Enter"!==t.key||!t.nativeEvent.isComposing&&!a.current)&&(e.submitKey===eM.mQ.AltEnter&&t.altKey||e.submitKey===eM.mQ.CtrlEnter&&t.ctrlKey||e.submitKey===eM.mQ.ShiftEnter&&t.shiftKey||e.submitKey===eM.mQ.MetaEnter&&t.metaKey||e.submitKey===eM.mQ.Enter&&!t.altKey&&!t.ctrlKey&&!t.shiftKey&&!t.metaKey)}}(),p=(0,D.useRef)(null),f=null!=p&&!!p.current&&1>=Math.abs(p.current.scrollHeight-(p.current.scrollTop+p.current.clientHeight)),{setAutoScroll:v,scrollDomToBottom:x}=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],[a,n]=(0,D.useState)(!0);function s(){let t=e.current;t&&requestAnimationFrame(()=>{n(!0),t.scrollTo(0,t.scrollHeight)})}return(0,D.useEffect)(()=>{a&&!t&&s()}),{scrollRef:e,autoScroll:a,setAutoScroll:n,scrollDomToBottom:s}}(p,f),[w,_]=(0,D.useState)(!0),k=(0,eP.S0)(),y=(0,eK.s0)(),[j,E]=(0,D.useState)([]),[b,C]=(0,D.useState)(!1),S=(0,eA.f)(),[M,P]=(0,D.useState)([]),N=(0,z.y1)(e=>{let t=S.search(e);P(t)},100,{leading:!0,trailing:!0}),[O,Z]=(0,D.useState)(2),A=(0,z.y1)(()=>{let e=o.current?(0,eP.lx)(o.current):1,t=Math.min(20,Math.max(2+Number(!k),e));Z(t)},100,{leading:!0,trailing:!0});(0,D.useEffect)(A,[c]);let H=(0,eW.UK)({new:()=>a.newSession(),newm:()=>y(eF.y$.NewChat),prev:()=>a.nextSession(-1),next:()=>a.nextSession(1),clear:()=>a.updateCurrentSession(e=>e.clearContextIndex=e.messages.length),del:()=>a.deleteSession(a.currentSessionIndex)}),T=e=>{m(e);let t=e.trim().length;0===t?P([]):e.startsWith(eW.x6)?P(H.search(e)):!s.disablePromptHint&&t<30&&e.startsWith("/")&&N(e.slice(1))},K=e=>{var t;if(""===e.trim())return;let n=H.match(e);if(n.matched){m(""),P([]),n.invoke();return}h(!0),a.onUserInput(e,j).then(()=>h(!1)),E([]),localStorage.setItem(eF.Sb,e),m(""),P([]),k||null===(t=o.current)||void 0===t||t.focus(),v(!0)},L=e=>{eZ.L.stop(n.id,e)};(0,D.useEffect)(()=>{a.updateCurrentSession(e=>{let t=Date.now()-eF.tb;e.messages.forEach(e=>{(e.isError||new Date(e.date).getTime()<t)&&(e.streaming&&(e.streaming=!1),0===e.content.length&&(e.isError=!0,e.content=(0,eU.B)({error:!0,message:"empty response"})))}),e.mask.syncGlobalConfig&&(console.log("[Mask] syncing from global, name = ",e.mask.name),e.mask.modelConfig={...s.modelConfig})})},[]);let R=(e,t)=>{(0,eP.Ri)(e.currentTarget,(0,eP.YK)(t))&&(0===c.length&&m((0,eP.YK)(t)),e.preventDefault())},B=e=>{a.updateCurrentSession(t=>t.messages=t.messages.filter(t=>t.id!==e))},U=e=>{B(e)},X=e=>{var t,s;let r,l;let i=n.messages.findIndex(t=>t.id===e.id);if(i<0||i>=n.messages.length){console.error("[Chat] failed to find resending message",e);return}if("assistant"===e.role){l=e;for(let e=i;e>=0;e-=1)if("user"===n.messages[e].role){r=n.messages[e];break}}else if("user"===e.role){r=e;for(let e=i;e<n.messages.length;e+=1)if("assistant"===n.messages[e].role){l=n.messages[e];break}}if(void 0===r){console.error("[Chat] failed to resend",e);return}B(r.id),B(null===(t=l)||void 0===t?void 0:t.id),h(!0);let c=(0,eP.YK)(r),m=(0,eP.Bs)(r);a.onUserInput(c,m).then(()=>h(!1)),null===(s=o.current)||void 0===s||s.focus()},V=e=>{a.updateCurrentSession(t=>t.mask.context.push(e)),(0,eD.CF)(eH.ZP.Chat.Actions.PinToastContent,{text:eH.ZP.Chat.Actions.PinToastAction,onClick:()=>{eu(!0)}})},J=(0,D.useMemo)(()=>n.mask.hideContext?[]:n.mask.context.slice(),[n.mask.context,n.mask.hideContext]),q=(0,eM._X)();if(0===J.length&&(null===(e=n.messages.at(0))||void 0===e?void 0:e.content)!==eM.ux.content){let e=Object.assign({},eM.ux);q.isAuthorized()||(e.content=eH.ZP.Error.Unauthorized),J.push(e)}let $=(0,D.useMemo)(()=>J.concat(n.messages).concat(d?[{...(0,eM.tn)({role:"assistant",content:""}),preview:!0}]:[]).concat(c.length>0&&s.sendPreviewBubble?[{...(0,eM.tn)({role:"user",content:c}),preview:!0}]:[]),[s.sendPreviewBubble,J,d,n.messages,c]),[ee,et]=(0,D.useState)(Math.max(0,$.length-eF.nS));function er(e){et(e=Math.max(0,e=Math.min($.length-eF.nS,e)))}let el=(0,D.useMemo)(()=>{let e=Math.min(ee+3*eF.nS,$.length);return $.slice(ee,e)},[ee,$]),ei=e=>{let t=e.scrollTop+e.clientHeight,a=e.clientHeight,n=e.scrollTop<=a,s=t>=e.scrollHeight-a,r=t>=e.scrollHeight-(k?4:10),l=ee-eF.nS,i=ee+eF.nS;n&&!s?er(l):s&&er(i),_(r),v(r)};function eo(){er($.length-eF.nS),x()}let em=(null!==(t=n.clearContextIndex)&&void 0!==t?t:-1)>=0?n.clearContextIndex+J.length-ee:-1,[eh,eu]=(0,D.useState)(!1),eg=(0,D.useMemo)(()=>(0,e6.Z)(),[]),ep=!k&&!(null==eg?void 0:eg.isApp);(0,eW.YZ)({fill:m,submit:e=>{K(e)},code:e=>{q.disableFastLink||(console.log("[Command] got code from url: ",e),(0,eD.i0)(eH.ZP.URLCommand.Code+"code = ".concat(e)).then(t=>{t&&q.update(t=>t.accessCode=e)}))},settings:e=>{if(!q.disableFastLink)try{let t=JSON.parse(e);console.log("[Command] got settings from url: ",t),(t.key||t.url)&&(0,eD.i0)(eH.ZP.URLCommand.Settings+"\n".concat(JSON.stringify(t,null,4))).then(e=>{e&&(t.key&&q.update(e=>e.openaiApiKey=t.key),t.url&&q.update(e=>e.openaiUrl=t.url))})}catch(t){console.error("[Command] failed to get settings from url: ",e)}}});let[ef,ev]=(0,D.useState)(!1);(0,D.useEffect)(()=>{let e=(0,eF.AI)(n.id),t=localStorage.getItem(e);t&&0===c.length&&(m(t),localStorage.removeItem(e));let a=o.current;return()=>{var t;localStorage.setItem(e,null!==(t=null==a?void 0:a.value)&&void 0!==t?t:"")}},[]);let ex=(0,D.useCallback)(async e=>{let t=a.currentSession().mask.modelConfig.model;if(!(0,eP.Xf)(t))return;let n=(e.clipboardData||window.clipboardData).items;for(let t of n)if("file"===t.kind&&t.type.startsWith("image/")){e.preventDefault();let a=t.getAsFile();if(a){let e=[];e.push(...j),e.push(...await new Promise((e,t)=>{C(!0);let n=[];(0,eP.hv)(a,262144).then(t=>{n.push(t),C(!1),e(n)}).catch(e=>{C(!1),t(e)})}));let t=e.length;t>3&&e.splice(3,t-3),E(e)}}},[j,a]);async function ew(){let e=[];e.push(...j),e.push(...await new Promise((e,t)=>{let a=document.createElement("input");a.type="file",a.accept="image/png, image/jpeg, image/webp, image/heic, image/heif",a.multiple=!0,a.onchange=a=>{C(!0);let n=a.target.files,s=[];for(let r=0;r<n.length;r++){let l=a.target.files[r];(0,eP.hv)(l,262144).then(t=>{s.push(t),(3===s.length||s.length===n.length)&&(C(!1),e(s))}).catch(e=>{C(!1),t(e)})}},a.click()}));let t=e.length;t>3&&e.splice(3,t-3),E(e)}return(0,I.jsxs)("div",{className:ez().chat,children:[(0,I.jsxs)("div",{className:"window-header","data-tauri-drag-region":!0,children:[k&&(0,I.jsx)("div",{className:"window-actions",children:(0,I.jsx)("div",{className:"window-action-button",children:(0,I.jsx)(eT.h,{icon:(0,I.jsx)(Y,{}),bordered:!0,title:eH.ZP.Chat.Actions.ChatList,onClick:()=>y(eF.y$.Home)})})}),(0,I.jsxs)("div",{className:"window-header-title ".concat(ez()["chat-body-title"]),children:[(0,I.jsx)("div",{className:"window-header-main-title ".concat(ez()["chat-body-main-title"]),onClickCapture:()=>ev(!0),children:n.topic?n.topic:eM.HX}),(0,I.jsx)("div",{className:"window-header-sub-title",children:eH.ZP.Chat.SubTitle(n.messages.length)})]}),(0,I.jsxs)("div",{className:"window-actions",children:[!k&&(0,I.jsx)("div",{className:"window-action-button",children:(0,I.jsx)(eT.h,{icon:(0,I.jsx)(W,{}),bordered:!0,onClick:()=>ev(!0)})}),(0,I.jsx)("div",{className:"window-action-button",children:(0,I.jsx)(eT.h,{icon:(0,I.jsx)(G,{}),bordered:!0,title:eH.ZP.Chat.Actions.Export,onClick:()=>{i(!0)}})}),ep&&(0,I.jsx)("div",{className:"window-action-button",children:(0,I.jsx)(eT.h,{icon:s.tightBorder?(0,I.jsx)(en.Z,{}):(0,I.jsx)(ea.Z,{}),bordered:!0,onClick:()=>{s.update(e=>e.tightBorder=!e.tightBorder)}})})]}),(0,I.jsx)(to,{showToast:!w,showModal:eh,setShowModal:eu})]}),(0,I.jsx)("div",{className:ez()["chat-body"],ref:p,onScroll:e=>ei(e.currentTarget),onMouseDown:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.blur()},onTouchStart:()=>{var e;null===(e=o.current)||void 0===e||e.blur(),v(!1)},children:el.map((e,t)=>{var l,i;let o="user"===e.role,c=t<J.length,d=t>0&&!(e.preview||0===e.content.length)&&!c,h=e.preview||e.streaming,u=t===em-1;return(0,I.jsxs)(D.Fragment,{children:[(0,I.jsx)("div",{className:o?ez()["chat-message-user"]:ez()["chat-message"],children:(0,I.jsxs)("div",{className:ez()["chat-message-container"],children:[(0,I.jsxs)("div",{className:ez()["chat-message-header"],children:[(0,I.jsxs)("div",{className:ez()["chat-message-avatar"],children:[(0,I.jsx)("div",{className:ez()["chat-message-edit"],children:(0,I.jsx)(eT.h,{icon:(0,I.jsx)(W,{}),onClick:async()=>{let t=await (0,eD.G5)(eH.ZP.Chat.Actions.Edit,(0,eP.YK)(e),10),n=t,s=(0,eP.Bs)(e);if(s.length>0){n=[{type:"text",text:t}];for(let e=0;e<s.length;e++)n.push({type:"image_url",image_url:{url:s[e]}})}a.updateCurrentSession(t=>{let a=t.mask.context.concat(t.messages).find(t=>t.id===e.id);a&&(a.content=n)})}})}),o?(0,I.jsx)(eL.qE,{avatar:s.avatar}):(0,I.jsx)(I.Fragment,{children:["system"].includes(e.role)?(0,I.jsx)(eL.qE,{avatar:"2699-fe0f"}):(0,I.jsx)(eR.MaskAvatar,{avatar:n.mask.avatar,model:e.model||n.mask.modelConfig.model})})]}),d&&(0,I.jsx)("div",{className:ez()["chat-message-actions"],children:(0,I.jsx)("div",{className:ez()["chat-input-actions"],children:e.streaming?(0,I.jsx)(td,{text:eH.ZP.Chat.Actions.Stop,icon:(0,I.jsx)(eb,{}),onClick:()=>L(null!==(l=e.id)&&void 0!==l?l:t)}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(td,{text:eH.ZP.Chat.Actions.Retry,icon:(0,I.jsx)(es.Z,{}),onClick:()=>X(e)}),(0,I.jsx)(td,{text:eH.ZP.Chat.Actions.Delete,icon:(0,I.jsx)(ec.Z,{}),onClick:()=>U(null!==(i=e.id)&&void 0!==i?i:t)}),(0,I.jsx)(td,{text:eH.ZP.Chat.Actions.Pin,icon:(0,I.jsx)(ed,{}),onClick:()=>V(e)}),(0,I.jsx)(td,{text:eH.ZP.Chat.Actions.Copy,icon:(0,I.jsx)(Q.Z,{}),onClick:()=>(0,eP.vQ)((0,eP.YK)(e))})]})})})]}),h&&(0,I.jsx)("div",{className:ez()["chat-message-status"],children:eH.ZP.Chat.Typing}),(0,I.jsxs)("div",{className:ez()["chat-message-item"],children:[(0,I.jsx)(tl,{content:(0,eP.YK)(e),loading:(e.preview||e.streaming)&&0===e.content.length&&!o,onContextMenu:t=>R(t,e),onDoubleClickCapture:()=>{k&&m((0,eP.YK)(e))},fontSize:r,parentRef:p,defaultShow:t>=el.length-6}),1==(0,eP.Bs)(e).length&&(0,I.jsx)("img",{className:ez()["chat-message-item-image"],src:(0,eP.Bs)(e)[0],alt:""}),(0,eP.Bs)(e).length>1&&(0,I.jsx)("div",{className:ez()["chat-message-item-images"],style:{"--image-count":(0,eP.Bs)(e).length},children:(0,eP.Bs)(e).map((e,t)=>(0,I.jsx)("img",{className:ez()["chat-message-item-image-multi"],src:e,alt:""},t))})]}),(0,I.jsx)("div",{className:ez()["chat-message-action-date"],children:c?eH.ZP.Chat.IsContext:e.date.toLocaleString()})]})}),u&&(0,I.jsx)(tm,{})]},e.id)})}),(0,I.jsxs)("div",{className:ez()["chat-input-panel"],children:[(0,I.jsx)(tc,{prompts:M,onPromptSelect:e=>{setTimeout(()=>{var t;P([]);let a=H.match(e.content);a.matched?(a.invoke(),m("")):m(e.content),null===(t=o.current)||void 0===t||t.focus()},30)}}),(0,I.jsx)(th,{uploadImage:ew,setAttachImages:E,setUploading:C,showPromptModal:()=>eu(!0),scrollToBottom:eo,hitBottom:w,uploading:b,showPromptHints:()=>{var e;if(M.length>0){P([]);return}null===(e=o.current)||void 0===e||e.focus(),m("/"),N("")}}),(0,I.jsxs)("label",{className:"".concat(ez()["chat-input-panel-inner"]," ").concat(0!=j.length?ez()["chat-input-panel-inner-attach"]:""),htmlFor:"chat-input",children:[(0,I.jsx)("textarea",{id:"chat-input",ref:o,className:ez()["chat-input"],placeholder:eH.ZP.Chat.Input(u),onInput:e=>T(e.currentTarget.value),value:c,onKeyDown:e=>{if("ArrowUp"===e.key&&c.length<=0&&!(e.metaKey||e.altKey||e.ctrlKey)){var t;m(null!==(t=localStorage.getItem(eF.Sb))&&void 0!==t?t:""),e.preventDefault();return}g(e)&&0===M.length&&(K(c),e.preventDefault())},onFocus:eo,onClick:eo,onPaste:ex,rows:O,autoFocus:!k,style:{fontSize:s.fontSize}}),0!=j.length&&(0,I.jsx)("div",{className:ez()["attach-images"],children:j.map((e,t)=>(0,I.jsx)("div",{className:ez()["attach-image"],style:{backgroundImage:'url("'.concat(e,'")')},children:(0,I.jsx)("div",{className:ez()["attach-image-mask"],children:(0,I.jsx)(tg,{deleteImage:()=>{E(j.filter((e,a)=>a!==t))}})})},t))}),(0,I.jsx)(eT.h,{icon:(0,I.jsx)(F,{}),text:eH.ZP.Chat.Send,className:ez()["chat-input-send"],type:"primary",onClick:()=>K(c)})]})]}),l&&(0,I.jsx)(e4,{onClose:()=>i(!1)}),ef&&(0,I.jsx)(tu,{onClose:()=>{ev(!1)}})]},n.id)}function tf(){let e=(0,eM.aK)(),t=e.currentSessionIndex;return(0,I.jsx)(tp,{},t)}},56963:function(e){e.exports={"message-exporter-body":"exporter_message-exporter-body__ieezO","export-content":"exporter_export-content__bLZvx",steps:"exporter_steps__6n3hv","steps-progress":"exporter_steps-progress__BaZCB","steps-progress-inner":"exporter_steps-progress-inner__Bx3Y4","steps-inner":"exporter_steps-inner__EVqvK",step:"exporter_step__WhCEO","step-finished":"exporter_step-finished__eBg9d","step-current":"exporter_step-current__oh5Mc","step-index":"exporter_step-index__bWRYR","step-name":"exporter_step-name__aj81m","preview-actions":"exporter_preview-actions__EdSLJ","image-previewer":"exporter_image-previewer__uKfNQ","preview-body":"exporter_preview-body__qK5Zf","chat-info":"exporter_chat-info__N_j5m",icons:"exporter_icons__7WRoV",logo:"exporter_logo__zu13e","main-title":"exporter_main-title__jjxAd","sub-title":"exporter_sub-title__p1RCl","icon-space":"exporter_icon-space__u_tMK","chat-info-item":"exporter_chat-info-item__3D12j",message:"exporter_message__3aahS",avatar:"exporter_avatar__fGOtt",body:"exporter_body__gcKIl","message-image":"exporter_message-image__ofOeC","message-images":"exporter_message-images__oJoIX","message-image-multi":"exporter_message-image-multi__jzQdX","message-assistant":"exporter_message-assistant__sDmHi","message-user":"exporter_message-user__2t254"}},25106:function(e){e.exports={"message-selector":"message-selector_message-selector__dOKbo","message-filter":"message-selector_message-filter__Q5XSd","search-bar":"message-selector_search-bar__4E5gq",actions:"message-selector_actions__MyZCT",messages:"message-selector_messages__GbOLr",message:"message-selector_message___TaV9","message-selected":"message-selector_message-selected__b3mDv",avatar:"message-selector_avatar__HCJ8t",body:"message-selector_body__rKEIZ",date:"message-selector_date__vc48w",content:"message-selector_content__Z9W8L",checkbox:"message-selector_checkbox__erPyd"}}}]);